"use strict";
// Copyright IBM Corp. 2020, 2024
Object.defineProperty(exports, "__esModule", { value: true });
const http = require("http");
const https = require("https");
const node_fetch_1 = require("node-fetch");
// workaround for https://github.com/steprz/stepzen-cli/issues/934
const httpAgent = new http.Agent({
    keepAlive: true,
    scheduling: 'lifo',
    timeout: 5000,
});
const httpsAgent = new https.Agent({
    keepAlive: true,
    scheduling: 'lifo',
    timeout: 5000,
});
const fetch = async (url, init) => {
    let urlstr;
    if (typeof url === 'string') {
        urlstr = url;
    }
    else if ('href' in url) {
        urlstr = url.href;
    }
    else {
        urlstr = url.url;
    }
    return (0, node_fetch_1.default)(url, {
        agent: urlstr.startsWith('https:') ? httpsAgent : httpAgent,
        ...init,
    });
};
exports.default = fetch;
//# sourceMappingURL=index.js.map